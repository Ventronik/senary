#!/usr/bin/env node

var  spawn = require('child_process').spawn,
userName = spawn('git', ['config', '--get', 'user.name']),
userEmail = spawn('git', ['config', '--get', 'user.email']),
g = spawn('git', ['commit', '-am', "Jooooooker"]);


userName.stdout.on('data', function (data) {
  console.log('User Name stdout: ' + data);
});

userEmail.stdout.on('data', function (data) {
  console.log('User email stdout: ' + data);
});

g.stdout.on('data', function (data) {
  console.log('g stdout: ' + data);
});

userName.stderr.on('data', function (data) {
  console.log('User name stderr: ' + data);
});

userEmail.stderr.on('data', function (data) {
  console.log('User email stderr: ' + data);
});

g.stderr.on('data', function (data) {
  console.log('g stderr: ' + data);
});

userName.on('exit', function (code) {
  console.log('User name child process exited with code ' + code);
});

userEmail.on('exit', function (code) {
  console.log('User email child process exited with code ' + code);
});

g.on('exit', function (code) {
  console.log('ug child process exited with code ' + code);
});

// git logs, parse stdout, and use jQuery Global plugin v1.0.0pre.

var spawn = require('child_process').spawn,
g = spawn('git', ['log'])

// date and fr modules are jQuery.global plugins ported to node
// date = require('./global'),
// fr = require('./fr');

g.stdout.on('data', function (s) {

  s = s.toString();

  var commits = s.split(/\n\nc/);

  commits.forEach(function(mit){
    mit = /^c/.test(mit) ? mit : 'c' + mit;

    var commit = mit.match(/[\da-f]{40}/),
    author = mit.match(/Author:\s([^<]+)?/),
    d = mit.match(/Date:\s*(.+)/),
    comment = mit.match(/\n\n\s*(.+)/);

    console.log('commit: ', commit[0]);
    console.log('author: ', author[1]);
    // console.log('date: ', date.format(new Date(d[1]), 'F', 'fr'));
    console.log('comment: ', comment[1]);

    console.log('\n\n');
  });



});

g.stderr.on('data', function (data) {
  console.log('g stderr: ' + data);
});

g.on('exit', function (code) {
  console.log('ug child process exited with code ' + code);
});
